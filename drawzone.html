
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>unblockzone - drawzone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      font-weight: bold;
      text-transform: lowercase;
      scrollbar-width: thin;
      scrollbar-color: #333333 #111111;
    }

html, body {
  margin: 0;
  padding: 0;
}

body {
  color: #f8f9fa;
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: relative;
  z-index: 1;
  background: url('https://images.unsplash.com/photo-1707924962886-12ad20367315?q=80&w=1632&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D') no-repeat center center fixed;
  background-size: cover;
}

body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-size: cover;
  z-index: -2;
  filter: brightness(0.7) blur(3px);
}

#particles-js {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  pointer-events: none;
}

.container {
  position: relative;
  z-index: 2;
  display: flex;
  flex-grow: 1;
  height: calc(100vh - 40px);
  width: 100vw;
  overflow: hidden;
}

.sidebar {
  position: fixed;
  width: 6vw;
  background: #343a40;
  box-shadow: 0 0 5px rgba(100, 149, 237, 0.3);
  height: 100vh;
  transition: width 0.3s ease-in-out;
  overflow: hidden;
  z-index: 999;
  top: 0;
  left: 0;
  transform: translateZ(0);
  margin-right: -1px;
}

.sidebar:hover {
  width: 15vw;
}

.sidebar ul {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding-top: 2rem;
  list-style-type: none;
}

.sidebar a {
  color: #f8f9fa;
  display: flex;
  align-items: center;
  text-decoration: none;
  padding: 0.5rem 0.8rem;
  border-radius: 2vh;
  transition: background 0.2s, transform 0.2s;
}

.sidebar a:hover {
  background: #495057;
  transform: scale(1.05);
}

.nav-container {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.icon {
  width: 2rem;
  height: 2rem;
  display: flex;
  justify-content: center;
  align-items: center;
}

.text {
  white-space: nowrap;
  opacity: 0;
  transform: translateX(-10px);
  transition: all 0.3s ease;
  font-size: 1.3rem;
}

.sidebar:hover .text {
  opacity: 1;
  transform: translateX(0);
}

.highlighted a {
  background: rgba(255, 255, 255, 0.1);
}

.sidebar:hover ~ .main-content {
  margin-left: 6vw;
  width: calc(100% - 6vw);
}

.main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  margin-left: 4.5vw;
  width: calc(100% - 4.5vw);
  transition: margin-left 0.3s ease-in-out, width 0.3s ease-in-out;
}

.content-area {
  flex-grow: 1;
  height: calc(100% - 70px);
  position: relative;
}

iframe {
  width: 100%;
  height: 100%;
  border: none;
  display: none;
}

.home-screen {
  width: 100%;
  height: 100%;
  background: transparent;
  position: absolute;
  top: 0;
  left: 0;
  overflow: hidden;
  z-index: 1;
}

.url-bar-icons {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-left: auto;
  margin-right: 5px;
}

.url-bar-icons i {
  cursor: pointer;
  font-size: 18px;
  color: #ced4da;
  transition: color 0.2s, transform 0.2s;
}

.url-bar-icons i:hover {
  color: #fff;
  transform: scale(1.1);
}

body.dark-mode {
  background: #000 !important;
}

body.dark-mode .browser-header,
body.dark-mode .sidebar {
  background-color: #000;
}

body.dark-mode .url-bar-wrapper {
  background-color: #222;
}

body.dark-mode .popup {
  background-color: #111;
}

body.incognito {
  background: url('https://garden.spoonflower.com/c/15197924/p/f/m/xIIl333PyyzkyIvJPgPxHyC8Zvdl-kAWYNamSdb5DXXqqKQU3gyFusuInw/Charcoal%20Grey%20Dark%20Gray%20Solid%20%234b4646.jpg') center/cover fixed !important;
}

body.incognito .browser-header,
body.incognito .sidebar {
  background-color: #222;
}

body.incognito .url-bar-wrapper {
  background-color: #444;
}

body.light-mode {
  background: #ffffff !important;
  color: #333333 !important;
}

body.light-mode .browser-header,
body.light-mode .sidebar {
  background-color: #f8f9fa !important;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

body.light-mode .url-bar-wrapper {
  background-color: #ffffff !important;
  border: 1px solid #dee2e6;
}

body.light-mode .url-bar {
  color: #333333 !important;
}

body.light-mode .sidebar a {
  color: #333333 !important;
}

body.light-mode .action-btn {
  color: #333333 !important;
}

body.light-mode .url-bar-icons i {
  color: #333333 !important;
}

.drawing-container {
  position: relative;
  margin-left: 8vw;
  margin-top: 2vh;
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

#drawingCanvas {
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  width: 800px;
  height: 600px;
}

.tools-container {
  display: flex;
  justify-content: center;
  gap: 2rem;
  padding: 1rem;
  background: rgba(52, 58, 64, 0.9);
  border-radius: 12px;
  margin-top: 1rem;
  backdrop-filter: blur(10px);
  animation: slideUp 0.5s ease-in-out;
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.tool-group {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.tool-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  padding: 0.8rem;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.tool-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
}

.tool-btn.active {
  background: rgba(255, 255, 255, 0.3);
  box-shadow: 0 0 10px rgba(255,255,255,0.2);
}

#color-picker {
  width: 50px;
  height: 50px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

#size-slider {
  width: 150px;
  cursor: pointer;
}

#size-label {
  color: white;
  min-width: 45px;
}

.drawing-container {
  position: relative;
  width: 95%;
  max-width: 1200px;
  margin: 2vh auto;
  padding: 0 15px;
  animation: fadeIn 0.5s ease-in-out;
}

#drawingCanvas {
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  width: 100%;
  height: auto;
  aspect-ratio: 4/3; /* Maintains proportion */
  touch-action: none; /* Prevents default touch behaviors */
}

.tools-container {
  display: flex;
  flex-wrap: wrap; /* Allows tools to wrap on small screens */
  justify-content: center;
  gap: 1rem;
  padding: 0.8rem;
  background: rgba(52, 58, 64, 0.9);
  border-radius: 12px;
  margin-top: 1rem;
  backdrop-filter: blur(10px);
}

/* Mobile-specific adjustments */
@media (max-width: 768px) {
  .tool-group {
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
    margin-bottom: 0.5rem;
  }

  .tool-btn {
    padding: 12px; /* Larger touch targets */
    font-size: 1.2rem;
  }

  #size-slider {
    width: 100%;
    max-width: 200px;
  }

  #color-picker {
    width: 40px;
    height: 40px;
  }
}

  </style>
</head>
<body>
  <div id="particles-js"></div>
  <div class="container">
    <div class="sidebar">
      <ul>
        <li>
          <a href="/index.html" class="home-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-house"></i></div>
              <div class="text">home</div>
            </div>
          </a>
        </li>
        <li>
          <a href="/g.html" class="games-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-gamepad"></i></div>
              <div class="text">games</div>
            </div>
          </a>
        </li>
        <li>
          <a href="/a.html" class="apps-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-mobile"></i></div>
              <div class="text">apps</div>
            </div>
          </a>
        </li>
        <li class="highlighted">
          <a href="/p.html" class="proxy-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-magnifying-glass"></i></div>
              <div class="text">proxy</div>
            </div>
          </a>
        </li>
        <li>
          <a href="/s.html" class="settings-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-cog"></i></div>
              <div class="text">settings</div>
            </div>
          </a>
        </li>
        <li>
          <a href="/partners.html" class="partners-link">
            <div class="nav-container">
              <div class="icon"><i class="fa-solid fa-handshake"></i></div>
              <div class="text">partners</div>
            </div>
          </a>
        </li>
      </ul>
    </div>

    <script src="settings.js" defer></script>
  
    <div class="main-content">
      <div class="content-area">
        <div class="home-screen" id="home-screen">
        </div>
        <iframe id="main-frame"></iframe>
      </div>
    </div>
  </div>
  
  <div class="drawing-container">
  <canvas id="drawingCanvas"></canvas>
  
  <div class="tools-container">
    <div class="tool-group">
      <button class="tool-btn" id="pencil-btn" title="Pencil">
        <i class="fas fa-pencil-alt"></i>
      </button>
      <button class="tool-btn" id="eraser-btn" title="Eraser">
        <i class="fas fa-eraser"></i>
      </button>
      <button class="tool-btn" id="clear-btn" title="Clear Canvas">
        <i class="fas fa-trash"></i>
      </button>
    </div>

    <div class="tool-group">
      <input type="color" id="color-picker" title="Choose Color">
      <input type="range" id="size-slider" min="1" max="50" value="5" title="Brush Size">
      <span id="size-label">5px</span>
    </div>

    <div class="tool-group">
      <button class="tool-btn" id="save-btn" title="Save as PNG">
        <i class="fas fa-download"></i>
      </button>
      <button class="tool-btn" id="bg-color-btn" title="Change Background">
        <i class="fas fa-fill-drip"></i>
      </button>
    </div>
  </div>
</div>


  <div id="particles-js"></div>

  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

  <div class="particles-container" id="particles-container"></div>

<script>
  const urlBar = document.getElementById('url-bar');
  const mainFrame = document.getElementById('main-frame');
  const homeScreen = document.getElementById('home-screen');
  const bookmarkIcon = document.getElementById('bookmark-icon');

  let iframeHistory = [];
  let currentIndex = -1;
  let currentUrl = '';
  let activePopup = null;

  // Bookmarks
  let bookmarks = JSON.parse(localStorage.getItem('bookmarks')) || [];
  const bookmarksList = document.getElementById('bookmarks-list');

  // History
  let searchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];
  const historyList = document.getElementById('history-list');

  // Extension States
  const extensionStates = {
      'dark-mode': false,
      'incognito': false,
      'download-manager': false,
      'ad-blocker': false,
      'light-mode': false
  };

  function updateIframe(originalUrl) {
    const cleanedUrl = originalUrl.replace(/^https?:\/\//, '');
    const proxiedUrl = "https://blockzone.github.io/active/iframe.html#https://" + cleanedUrl;

    mainFrame.src = proxiedUrl;
    mainFrame.style.display = "block";
    homeScreen.style.display = "none";

    urlBar.value = originalUrl;
    currentUrl = originalUrl;

    if (bookmarks.some(bookmark => bookmark.url === currentUrl)) {
        bookmarkIcon.classList.add('bookmarked');
    } else {
        bookmarkIcon.classList.remove('bookmarked');
    }
  }

  function navigateToUrl(input) {
    if (!input.trim()) return;

    let formattedUrl = input.trim();

    if (!formattedUrl.startsWith("http://") && !formattedUrl.startsWith("https://")) {
      if (formattedUrl.includes(".")) {
        formattedUrl = "https://" + formattedUrl;
      } else {
        formattedUrl = "https://duckduckgo.com/?q=" + encodeURIComponent(formattedUrl);
      }
    }

    iframeHistory = iframeHistory.slice(0, currentIndex + 1);
    iframeHistory.push(formattedUrl);
    currentIndex++;
    updateIframe(formattedUrl);

    addSearchToHistory(formattedUrl);
  }

  urlBar.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      e.preventDefault();
      navigateToUrl(urlBar.value);
    }
  });

  document.getElementById("back-btn").onclick = () => {
    if (currentIndex > 0) {
      currentIndex--;
      updateIframe(iframeHistory[currentIndex]);
    }
  };

  document.getElementById("forward-btn").onclick = () => {
    if (currentIndex < iframeHistory.length - 1) {
      currentIndex++;
      updateIframe(iframeHistory[currentIndex]);
    }
  };

  document.getElementById("reload-btn").onclick = () => {
    if (currentIndex >= 0) {
      updateIframe(iframeHistory[currentIndex]);
    }
  };

  function bookmarkCurrentPage() {
    if (!currentUrl) return;

    const pageTitle = currentUrl;
    const bookmark = { url: currentUrl, title: pageTitle };

    const isBookmarked = bookmarks.some(b => b.url === currentUrl);

    if (isBookmarked) {
      bookmarks = bookmarks.filter(b => b.url !== currentUrl);
      bookmarkIcon.classList.remove('bookmarked');
    } else {
      bookmarks.push(bookmark);
      bookmarkIcon.classList.add('bookmarked');
    }

    localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
  }

  function addSearchToHistory(url) {
    searchHistory.unshift(url);
    searchHistory = searchHistory.slice(0, 10);
    localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
  }

  function toggleExtension(extensionName) {
    extensionStates[extensionName] = !extensionStates[extensionName];
    const toggleElement = document.querySelector(`.extension-toggle[data-extension="${extensionName}"] i`);

    if (extensionStates[extensionName]) {
      if (extensionName === 'dark-mode') {
        document.body.classList.add('dark-mode');
      } else if (extensionName === 'incognito') {
        document.body.classList.add('incognito');
      } else if (extensionName === 'light-mode') {
        document.body.classList.add('light-mode');
        localStorage.setItem('lightMode', 'enabled');
      }
    } else {
      if (extensionName === 'dark-mode') {
        document.body.classList.remove('dark-mode');
      } else if (extensionName === 'incognito') {
        document.body.classList.remove('incognito');
      } else if (extensionName === 'light-mode') {
        document.body.classList.remove('light-mode');
        localStorage.setItem('lightMode', 'disabled');
      }
    }
  }

  if (localStorage.getItem('lightMode') === 'enabled') {
    document.body.classList.add('light-mode');
    extensionStates['light-mode'] = true;
  }

  function loadSavedExtensionStates() {
    const savedStates = JSON.parse(localStorage.getItem('extensionStates')) || {};
    Object.keys(savedStates).forEach(extension => {
      if (savedStates[extension]) {
        extensionStates[extension] = true;
        applyExtensionState(extension, true);
      }
    });
  }

  function applyExtensionState(extensionName, state) {
    switch (extensionName) {
      case 'dark-mode':
        document.body.classList.toggle('dark-mode', state);
        break;
      case 'incognito':
        document.body.classList.toggle('incognito', state);
        break;
      case 'ad-blocker':
        state ? enableAdBlocker() : disableAdBlocker();
        break;
      case 'light-mode':
        document.body.classList.toggle('light-mode', state);
        break;
    }
  }

  function enableAdBlocker() {
    const adPatterns = [
      'ads', 'advertisement', 'banner', 'sponsor', 'advertising',
      'google_ads', 'adsense', 'advert', 'promotions', 'sponsored'
    ];
    setInterval(() => {
      if (extensionStates['ad-blocker']) {
        const elements = document.querySelectorAll('iframe, div, img, a');
        elements.forEach(el => {
          const str = (el.id + ' ' + el.className + ' ' + el.src + ' ' + el.href).toLowerCase();
          if (adPatterns.some(pattern => str.includes(pattern))) {
            el.style.display = 'none';
          }
        });
      }
    }, 1000);
  }

  document.addEventListener('DOMContentLoaded', () => {
    loadSavedExtensionStates();

    const theme = window.theme || {};

    particlesJS("particles-js", {
      "particles": {
        "number": { "value": 20, "density": { "enable": false } },
        "color": { "value": theme.particleColor || "#ffffff" },
        "shape": { "type": "circle" },
        "opacity": { "value": 0.7, "random": true },
        "size": { "value": 3, "random": true },
        "line_linked": {
          "enable": true,
          "distance": 150,
          "color": theme.particleLinks || "#ffffff",
          "opacity": 0.6,
          "width": 1
        },
        "move": {
          "enable": true,
          "speed": 2,
          "direction": "none",
          "random": true,
          "straight": false,
          "out_mode": "out",
          "bounce": false
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": { "enable": false },
          "onclick": { "enable": false },
          "resize": true
        }
      },
      "retina_detect": false
    });
  });
  
  document.addEventListener('DOMContentLoaded', () => {
  const canvas = document.getElementById('drawingCanvas');
  const ctx = canvas.getContext('2d');
  const tools = {
    pencil: document.getElementById('pencil-btn'),
    eraser: document.getElementById('eraser-btn'),
    clear: document.getElementById('clear-btn'),
    save: document.getElementById('save-btn'),
    bgColor: document.getElementById('bg-color-btn'),
    colorPicker: document.getElementById('color-picker'),
    sizeSlider: document.getElementById('size-slider'),
    sizeLabel: document.getElementById('size-label')
  };

  let isDrawing = false;
  let currentTool = 'pencil';
  let currentColor = '#000000';
  let currentSize = 5;
  let lastX = 0;
  let lastY = 0;

  // Set canvas size
  function resizeCanvas() {
    canvas.width = 800;
    canvas.height = 600;
    loadDrawing(); // Reload saved drawing after resize
  }
  resizeCanvas();

  // Tool functions
  function setTool(tool) {
    currentTool = tool;
    document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));
    tools[tool].classList.add('active');
  }

  // Drawing functions
  function startDrawing(e) {
    isDrawing = true;
    [lastX, lastY] = [e.offsetX, e.offsetY];
  }

  function draw(e) {
    if (!isDrawing) return;

    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(e.offsetX, e.offsetY);
    ctx.strokeStyle = currentTool === 'eraser' ? canvas.style.backgroundColor || '#ffffff' : currentColor;
    ctx.lineWidth = currentSize;
    ctx.lineCap = 'round';
    ctx.stroke();

    [lastX, lastY] = [e.offsetX, e.offsetY];
    saveDrawing();
  }

  function stopDrawing() {
    isDrawing = false;
  }

  // Save and load functions
  function saveDrawing() {
    localStorage.setItem('drawing', canvas.toDataURL());
  }

  function loadDrawing() {
    const savedDrawing = localStorage.getItem('drawing');
    if (savedDrawing) {
      const img = new Image();
      img.onload = () => {
        ctx.drawImage(img, 0, 0);
      };
      img.src = savedDrawing;
    }
  }

  // Event listeners
  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseout', stopDrawing);

  tools.pencil.addEventListener('click', () => setTool('pencil'));
  tools.eraser.addEventListener('click', () => setTool('eraser'));
  
  tools.clear.addEventListener('click', () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    saveDrawing();
  });

  tools.save.addEventListener('click', () => {
    const link = document.createElement('a');
    link.download = 'drawing.png';
    link.href = canvas.toDataURL();
    link.click();
  });

  tools.bgColor.addEventListener('click', () => {
    const color = prompt('Enter background color (e.g., #ffffff or white):');
    if (color) {
      canvas.style.backgroundColor = color;
      saveDrawing();
    }
  });

  tools.colorPicker.addEventListener('input', (e) => {
    currentColor = e.target.value;
  });

  tools.sizeSlider.addEventListener('input', (e) => {
    currentSize = e.target.value;
    tools.sizeLabel.textContent = `${currentSize}px`;
  });

  // Initialize
  setTool('pencil');
  loadDrawing();
});

// Add these functions to your existing JavaScript
function getCoordinates(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;

  if (e.type.includes('touch')) {
    return {
      x: (e.touches[0].clientX - rect.left) * scaleX,
      y: (e.touches[0].clientY - rect.top) * scaleY
    };
  }
  return {
    x: (e.clientX - rect.left) * scaleX,
    y: (e.clientY - rect.top) * scaleY
  };
}

function initCanvas() {
  const container = canvas.parentElement;
  const containerWidth = container.clientWidth;
  canvas.width = containerWidth - 30; // Account for padding
  canvas.height = (containerWidth - 30) * 0.75; // 4:3 aspect ratio
  loadDrawing();
}

// Update event listeners for touch support
canvas.addEventListener('touchstart', (e) => {
  e.preventDefault();
  const coords = getCoordinates(e);
  isDrawing = true;
  [lastX, lastY] = [coords.x, coords.y];
});

canvas.addEventListener('touchmove', (e) => {
  e.preventDefault();
  if (!isDrawing) return;
  const coords = getCoordinates(e);
  
  ctx.beginPath();
  ctx.moveTo(lastX, lastY);
  ctx.lineTo(coords.x, coords.y);
  ctx.strokeStyle = currentTool === 'eraser' ? canvas.style.backgroundColor || '#ffffff' : currentColor;
  ctx.lineWidth = currentSize;
  ctx.lineCap = 'round';
  ctx.stroke();

  [lastX, lastY] = [coords.x, coords.y];
  saveDrawing();
});

canvas.addEventListener('touchend', stopDrawing);
canvas.addEventListener('touchcancel', stopDrawing);

// Add resize handler
window.addEventListener('resize', debounce(() => {
  initCanvas();
}, 250));

// Debounce function to prevent excessive resize calculations
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// Initialize canvas on load
document.addEventListener('DOMContentLoaded', () => {
  initCanvas();
  // ... rest of your initialization code
});

</script>

</body>
</html>
